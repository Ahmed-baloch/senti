// Potential log4j access detected from IP's 45.155.205
let log4jcmd = dynamic([
"jndi:ldap","jndi:dns","jndi:rmi","jndi:corba","jndi:iiop","jndi:nis","jndi:nds",
"${jndi:${lower:l}${lower:d}${lower:a}${lower:p}://",
"${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://"
]);
AzureDiagnostics
| where originalRequestUriWithArgs_s has_any (log4jcmd)
| where userAgent_s has_any ("curl")
| summarize Total = count() by originalRequestUriWithArgs_s, userAgent_s, clientIP_s, TimeGenerated, host_s, requestUri_s, httpStatus_d,listenerName_s
| sort by originalRequestUriWithArgs_s asc, Total desc 
