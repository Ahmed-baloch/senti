// Potential exploitation of Apache log4j component detected
let log4jcmd = dynamic(["jndi:ldap","jndi:dns","jndi:rmi","jndi:corba","jndi:iiop","jndi:nis","jndi:nds"]);
AzureDiagnostics
| where originalRequestUriWithArgs_s has_any (log4jcmd)
| where userAgent_s has_any ("curl", "wget")
| summarize Total = count() by originalRequestUriWithArgs_s, userAgent_s, clientIP_s, TimeGenerated, host_s, requestUri_s, httpStatus_d,listenerName_s
| sort by originalRequestUriWithArgs_s asc, Total desc 
